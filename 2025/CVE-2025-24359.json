{
    "id": "CVE-2025-24359",
    "product": "asteval",
    "version": "= < 1.0.6 ",
    "vulnerability": [
        "CWE-134: Use of Externally-Controlled Format String",
        "CWE-749: Exposed Dangerous Method or Function"
    ],
    "description": "ASTEVAL is an evaluator of Python expressions and statements. Prior to version 1.0.6, if an attacker can control the input to the `asteval` library, they can bypass asteval's restrictions and execute arbitrary Python code in the context of the application using the library. The vulnerability is rooted in how `asteval` performs handling of `FormattedValue` AST nodes. In particular, the `on_formattedvalue` value uses the dangerous format method of the str class. The code allows an attacker to manipulate the value of the string used in the dangerous call `fmt.format(__fstring__=val)`. This vulnerability can be exploited to access protected attributes by intentionally triggering an `AttributeError` exception. The attacker can then catch the exception and use its `obj` attribute to gain arbitrary access to sensitive or protected object properties. Version 1.0.6 fixes this issue.",
    "poc": {
        "reference": [
            "https://github.com/lmfit/asteval/security/advisories/GHSA-3wwr-3g9f-9gc7"
        ],
        "github": [
            "No PoCs found on GitHub currently."
        ]
    }
}