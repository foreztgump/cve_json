{
    "id": "CVE-2025-15284",
    "product": "null",
    "version": "< 6.14.1 ",
    "vulnerability": [
        "CWE-20 Improper Input Validation"
    ],
    "description": "Improper Input Validation vulnerability in qs (parse modules) allows HTTP DoS.This issue affects qs: < 6.14.1.SummaryThe arrayLimit\u00a0option in qs did not enforce limits for bracket notation (a[]=1&a[]=2), only for indexed notation (a[0]=1). This is a consistency bug; arrayLimit\u00a0should apply uniformly across all array notations.Note:\u00a0The default parameterLimit\u00a0of 1000 effectively mitigates the DoS scenario originally described. With default options, bracket notation cannot produce arrays larger than parameterLimit\u00a0regardless of arrayLimit, because each a[]=valueconsumes one parameter slot. The severity has been reduced accordingly.DetailsThe arrayLimit\u00a0option only checked limits for indexed notation (a[0]=1&a[1]=2) but did not enforce it for bracket notation (a[]=1&a[]=2).Vulnerable code\u00a0(lib/parse.js:159-162):if (root === '[]' && options.parseArrays) {    obj = utils.combine([], leaf);  // No arrayLimit check}Working code\u00a0(lib/parse.js:175):else if (index <= options.arrayLimit) {  // Limit checked here    obj = [];    obj[index] = leaf;}The bracket notation handler at line 159 uses utils.combine([], leaf)\u00a0without validating against options.arrayLimit, while indexed notation at line 175 checks index <= options.arrayLimit\u00a0before creating arrays.PoCconst qs = require('qs');const result = qs.parse('a[]=1&a[]=2&a[]=3&a[]=4&a[]=5&a[]=6', { arrayLimit: 5 });console.log(result.a.length);  // Output: 6 (should be max 5)Note on parameterLimit interaction:\u00a0The original advisory's \"DoS demonstration\" claimed a length of 10,000, but parameterLimit\u00a0(default: 1000) caps parsing to 1,000 parameters. With default options, the actual output is 1,000, not 10,000.ImpactConsistency bug in arrayLimit\u00a0enforcement. With default parameterLimit, the practical DoS risk is negligible since parameterLimit\u00a0already caps the total number of parsed parameters (and thus array elements from bracket notation). The risk increases only when parameterLimit\u00a0is explicitly set to a very high value.",
    "poc": {
        "reference": [
            "https://github.com/ljharb/qs/security/advisories/GHSA-6rw7-vpxm-498p"
        ],
        "github": [
            "No PoCs found on GitHub currently."
        ]
    }
}